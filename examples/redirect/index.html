<html>
  <head>
    <title>js.js Redirect Protection</title>
    <script type="text/javascript" src="../../src/libjs.O2.js"></script>
    <script type="text/javascript" src="../../src/jsjs-wrapper.js"></script>
    <script type="text/javascript"> 
    var src = ' document.getElementById("redirection-result").innerHTML = "Protected Gadget trying to redirect page"; window.top.location = "http://www.thinkfu.com/evil.gif"; ';
    	
      function jsjsProt() {
        var jsObjs = JSJS.Init();
        var ok = JSJS.InitDocument(jsObjs, 'locked');
        JSJS.UnlockElement(document.getElementById('redirection-result'));

        JSJS.InitWindow(jsObjs, 'locked');

        var rval = JSJS.EvaluateScript(jsObjs.cx, jsObjs.glob, src);
        JSJS.End(jsObjs);
	    }

      function jsjsUnprot() {
        var jsObjs = JSJS.Init();
        var ok = JSJS.InitDocument(jsObjs, 'unlocked');
        JSJS.UnlockElement(document.getElementById('redirection-result'));

        JSJS.InitWindow(jsObjs, 'unlocked');

        var rval = JSJS.EvaluateScript(jsObjs.cx, jsObjs.glob, src);
        JSJS.End(jsObjs);
	    }


      var godoevil = function() { 
        document.getElementById("redirection-result").innerHTML = "Gadget trying to redirect page"; 
        top.location = "http://www.thinkfu.com/evil.gif"; 
      }

    </script>

  </head>
  <body>
    <h1> js.js Redirect Protection</h1>
    <form>
      <input type="button" value="Protected Go Do Evil Redirection" onclick="jsjsProt()" >
      <input type="button" value="Unprotected Go Do Evil Redirection" onclick="jsjsUnprot()" >
      <input type="button" value="Native Go Do Evil Redirection" onclick="godoevil()" >
    </form>
    <label for="redirection-result">Result:</label><div id="redirection-result"></div>
  </body>
</html>
