<html>
  <head>
    <title>js.js access-binary-trees benchmark test</title>
    <script type="text/javascript" src="../../../../../src/js.O1.js"></script>
    <script type="text/javascript" src="../../../../../src/jsjs-wrapper.js"></script>

   <script type="text/javascript">
    function start_jsjs() {
	 var xhr = new XMLHttpRequest();
	 xhr.open('GET', './crypto-aes-src.js', false);
   	 xhr.send(null);
 
 	 if (xhr.status === 200) 
         console.log(xhr.responseText);

         console.log(xhr.status);
	 var src =  xhr.responseText;
 
        print("About to execute: " + src);
        var jsObjs = JSJS.Init();
    
        //Define a global object called "record" that calls record function,
        // taking one double as input, logging the result, and returning the result
        function record(txt) {
            console.log("record got " + txt);
            return txt;
        }
        var wrappedNativeFunc = JSJS.wrapFunction({
            func: record,
            args: [JSJS.Types['double']],
            returns: JSJS.Types['double']});
        JSJS.DefineFunction(jsObjs.cx, jsObjs.glob, "record", wrappedNativeFunc, 2, 0);
        
        var rval = JSJS.EvaluateScript(jsObjs.cx, jsObjs.glob, src);
        
        var d;
        if (rval) {
            //Convert the JSVal to a double
            d = JSJS.ValueToNumber(jsObjs.cx, rval);
        } else {
            d = "Can't get result because an error happened.";
        }
    
        document.getElementById("demo").innerHTML = d;
        
        // This is how you do a proper shut down
        JSJS.End(jsObjs);
    }
    
    window.onload = start_jsjs;

    </script>
  </head>
  <body>
    <h1>js.js access-binary-trees benchmark test</h1>
    <h2>If all goes well, the following should be replaced by the result of "access-binary-trees javascript benchmark":</h2>
    <p id="demo">This will get replaced by the numeric result of the source being evaluated.</p>
  </body>
</html>
